import os
try:
    from style import *
    import json  # json writing
    import requests  # web requests/packets
    import time
    import sys
except ImportError as e:
    print(f"installing modules")
    os.system(r"pip install -r packages.txt")
    from style import *
    import json  # json writing
    import requests  # web requests/packets
    import time
    import sys


#animation

#banner
AI =  MainColor2(r""" 
       .---:                                                                             .:--:.     
     :*******-                                                                         .*******=.   
    :*********-                     .:::::::::::::::::::.:.:::....                    .*********+.  
    -*********=                   .-----------::::::::::::::::...:.                   :**********.  
    .+********.                  .-===------------::::::::::::...::.                   *********=   
     .-*****-                     -=======-------------::::::::::::.                    -******:    
       :+++:                      .============-------------------:                      .+++=      
       :**+:              ...  .... :=============--------------:.   ..    .             .+*+=.     
       :***:          ...:::::::::::::::::::::::::::::::.....................            .+**=      
       :***:     ...:::::::::::::::::::::::::::::::::::..........................         +**=      
       :***:     .:-::::::::::::::::::::::::::::::::::.............................      .+**=.     
       :***:   .:---:::::::::::::::::::::::::::::::::................................    .+**=.     
       :***:  .-----::::::::::::::::::::::::::::::::...................................  .+**=      
       :***: :------::::::::::::::::::::::::::::::::.................................... .+**=      
       :***:.-------::::::::::::::::::::::::::::::::::::::::::::..........................+**=.     
       :***:-----------*#####################################################*-...........***=      
       :***--------=*############################################################=........***=      
       :***=-----=*################################################################=......***+.     
       :***=----+###################################################################+.....+**+      
     .-****=---=############*+==---###############################*+==---############+....+++++:    
    .=*****=--=#############++==----##############################++==---=############-...++++++:   
    :******=--=#############++==----##############################++==---=############*...++++++=.  
    -******=--+#############++==----##############################++==---=############*...+++++++.  
    -******=--=#############++==----##############################++==---=############+...+++++++.  
    -******=--=*############++===---##############################++===--=############-...+++++++.  
    -******=---=############++===--=##############################++===--=###########+....+++++++.  
    -******=----=###########*+===-=*##############################*+===-=*##########+.....+++++++.  
   .-******=-----=******###########***************************###########**********-......+*+++++.  
    -******=-------=********#####********************************#####***********=........**+++*+.  
    -******=--------:--+******************************************************-:..........***+**+.  
    -******=--------::::::::::::::::::::::::::::::::::::::::::::::::::::::................******+.  
   .-******=--------:::::::::::::::::::::::::::::::::::::::::::::.........................******+.  
    -******=--------:::::::::::::::::::::::::::::::::::::::::::::::.......................*******.  
    -******=--------::::::::::::::::::::::::::::::::::::::::::::::::......................*******.  
   .-******=--------::::::::::::::::::::::::::::::::::::::::::::::::::...................:*******.  
    :******=--------:::::::::::::::::::::::::::::::::::::::::::::::::::..................:******=.  
     =*****=--------::::::::::::::::::::::::::::::::::::::::::::::::::::.................:*****+..  
      .=***=--------:::::::::::::::::::::::::::::::::::::::::::::::::::::................:***+:     
         .:---------:::::::::::::::::::-+********************=:::::::::::::.................        
           ---------::::::::::::::::::*########################-:::::::::::................         
           ---------:::::::::::::::::-##########################::::::::::::..............          
           :--------:::::::::::::::::-#########################*:::::::::::::.............          
           .--------::::::::::::::::::=#######################*:::::::::::::::.............         
            :-------::::::::::::::::::::-====================-::::::::::::::::::..........          
             -------::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::.....:.           
             .-------::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::.            
               :-----:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::.             
               ..:---------:::::::::::::::::::::::::::::::::::::::::::::::::::::::::.               
                  .:----------------------------------------------------------::::.                 
                     .:-------------------------------------------------------::.                   
                        ..::::-----------::-----:-----:-----::----:----:::::.                       

""")

# api keys for auth
#get keys at: https://aimlapi.com/
##############################################################################################################
api_keys = {
    "",
    "",
    "",
    "",
    "",
    "",
}
api_url = "https://api.aimlapi.com/v1/chat/completions"
##############################################################################################################
def type_text(text, delay=0.05):
    for char in text:
        sys.stdout.write(char)
        sys.stdout.flush()
        time.sleep(delay)
    print()
def send_message(user_message):
    if not user_message:
        print("Error: No message entered.")
        return
#tells the ai what to do sends users prompt to api and ai returns to answer to api which sends it back to user terminal
    payload = {
        "model": "gpt-3.5-turbo",
        "messages": [
            {"role": "user", "content": user_message}
        ]
    }
# 1 api key = 20 prompts
    #solve this by creating more
    # about 100 prompts per day
    # function to cycle if 1 is invalid
    for api_key in api_keys:
        try:
            response = requests.post(api_url, headers={
                "Authorization": f"Bearer {api_key}",
                "Content-Type": "application/json"
            }, data=json.dumps(payload))

            #error handle
            data = response.json()

            if data and "choices" in data:
                ai_message = data["choices"][0]["message"]["content"]
                sys.stdout.write(f"{lc}Cyanü§ñ: {white}")
                type_text(f"{white} {ai_message}", 0.005)

                break  # Exit loop if the request is successful
            else:
                print("Error: Unable to retrieve response. Trying next API key.")
                print(f"{red}Switching to the next API key, please wait...")

        except requests.exceptions.RequestException as error:
            print(f"{red}Error: Unable to connect with API key {api_key}. {error}")
            print(f"{red}Attempting to use the next available API key...")


# rest
#cyan msg to client
def Cyan_AI():
    Slow(AI)
    print(
        f'{green}Remember to type {red}exit {green} once you have completed your prompts!')
    sys.stdout.write(f"{lc}Cyanü§ñ: {white}")
    type_text(f"{white} Hello, how can I help you today? üòÅ", 0.005)
    while True:
        user_input = input(f"{yellow}\büë®‚ÄçüíªYou: ")
        if user_input.lower() == "exit":
            print(f'{red}Exiting program.')
            break
        send_message(user_input)

Cyan_AI()


